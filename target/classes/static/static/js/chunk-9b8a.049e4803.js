(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-9b8a"],{"C/qp":function(t,e,r){"use strict";r.r(e);var s=r("P2sY"),n=r.n(s),o={name:"sensortypeedit",mixins:[r("y2a5").a],components:{},props:{paramsObj:{type:Object,default:function(){return{}}}},data:function(){return{newSensortypeForm:{id:0,title:"",url:""},sensortypeForm:{}}},mounted:function(){this.pObj=n()({},this.paramsObj),this.gcomm.mapLength(this.pObj)>0?(this.isInDialog=!0,this.sensortypeForm=n()({},this.newSensortypeForm,this.pObj)):this.sensortypeForm=n()({},this.newSensortypeForm,this.$route.params)},methods:{pObjChanged:function(){this.gcomm.mapLength(this.pObj)>0&&(this.isInDialog=!0,this.sensortypeForm=n()({},this.newSensortypeForm,this.pObj))},genUploadUrl:function(t){return this.hysrvport+"/hyupload?btnEncode=headupload&relateType=camera&fi=add&Authorization="+this.apiSrv.token},genDownUrl:function(t){if(!t||t.length<1)return"";var e=t.split(";");return!e||e.length<2?"":this.hysrvport+"/hydownload?btnEncode=headupload&relateType=camera&filename="+e[1]+"&Authorization="+this.apiSrv.token},handleAvatarSuccess:function(t,e){this.sensortypeForm.url=t.data},handleClick:function(){console.log("数据",this.sensortypeForm),this.submitOrgForm("sensortypeForm")},submitOrgFormImpl:function(t){var e=this,r=void 0,s=!0,o="";this[t].id>0?(r="/act",s=!1,o="sensorup"):(r="/act",o="sensoradd",this[t].state="关闭");var i=n()({},this[t]);i._hy=o,this.callSrvAct(r,i).then(function(t){e.isInDialog?(console.log("不跳转"),s?t.data&&t.data.inst?(console.log("1111111111"),e.$emit("submitOk",t.data.inst)):t.data&&(console.log("22222222222"),e.$emit("submitOk",t.data||{})):e.$emit("submitOk",i)):(console.log("跳转"),e.$router.go(-1))})},submitOrgForm:function(t){var e=this;this.$refs[t].validate(function(r){if(!r)return!1;e.submitOrgFormImpl(t)})},close:function(){this.sensortypeForm.url="",this.$refs.box.clearFiles()},goClick:function(){this.$emit("submitClose")}},watch:{paramsObj:function(t){this.pObj.id!=this.paramsObj.id&&(this.pObj=n()({},this.paramsObj),this.pObjChanged())}},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},i=(r("EeUz"),r("KHd+")),a=Object(i.a)(o,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-container",{attrs:{direction:"vertical"}},[r("el-form",{ref:"sensortypeForm",attrs:{model:t.sensortypeForm}},[r("el-form-item",{attrs:{label:"传感器名称：",prop:"title",rules:{required:!0,trigger:"input"}}},[r("el-input",{staticStyle:{width:"300px"},model:{value:t.sensortypeForm.title,callback:function(e){t.$set(t.sensortypeForm,"title",e)},expression:"sensortypeForm.title"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"图标：",prop:"url"}},[r("el-upload",{ref:"box",staticStyle:{border:"1px solid #d9d9d9","border-radius":"6px",cursor:"pointer",position:"relative",overflow:"hidden",width:"100%",height:"178px","line-height":"178px","text-align":"center"},attrs:{action:t.genUploadUrl(),multiple:!1,"on-success":t.handleAvatarSuccess,limit:0,id:"box"}},[t.sensortypeForm.url?r("img",{staticStyle:{"object-fit":"fill"},attrs:{src:t.genDownUrl(t.sensortypeForm.url)}}):r("svg-icon",{staticStyle:{"font-size":"28px",color:"#8c939d"},attrs:{"icon-class":"add"}}),t._v(" "),t.sensortypeForm.url?r("span",{ref:"clos",staticStyle:{position:"absolute",top:"0px",right:"0px"},attrs:{id:"clos"}},[r("i",{staticClass:"el-icon-close",staticStyle:{position:"absolute",top:"0px",right:"0px"},on:{click:function(e){return e.stopPropagation(),t.close(e)}}})]):t._e()],1)],1)],1),t._v(" "),r("div",{staticStyle:{"text-align":"center"}},[r("el-button",{on:{click:t.handleClick}},[r("span",[t._v("确定\n            ")])]),t._v(" "),r("el-button",{on:{click:t.goClick}},[r("span",[t._v("取消\n            ")])])],1)],1)},[],!1,null,"298f4c39",null);a.options.__file="index.vue";e.default=a.exports},EeUz:function(t,e,r){"use strict";var s=r("mH47");r.n(s).a},mH47:function(t,e,r){},y2a5:function(t,e,r){"use strict";var s=r("gDS+"),n=r.n(s),o=r("4d7F"),i=r.n(o);e.a={methods:{cb_null:function(t){return!1},cb_goBack:function(t){return this.$router.go(-1),!0},cb_success:function(t){return!(!t.status||"SUCCESS"!=t.status)||(this.$message.error(t.msg),!1)},cb_showMess:function(t){return this.$message.success(t.msg),!0},gen_sameValue:function(t,e){return function(r,s,n){s!=t?n(new Error(e)):n()}},refreshCaptcha:function(t){t.preventDefault(),t.target.src=this.hysrvport+"/captcha?"+Math.random()},add_authToken:function(t){return t.length<1?"":t=t.indexOf("?")>-1?t+"&Authorization="+this.apiSrv.token:t+"?Authorization="+this.apiSrv.token},callServer:function(t,e,r){var s=this;this.apiSrv.callServer(t,e).then(function(t){if(console.log("res ------",t),r)for(var e=0;e<r.length;e++){if(r[e])if(!r[e](t))break}}).catch(function(t){console.log("err:",t),s.$message.error(t)})},callSrvAct:function(t,e){var r=this;return new i.a(function(s,n){r.apiSrv.callServer(t,e).then(function(t){t.status&&"SUCCESS"==t.status?s(t):(console.log("res:",t),r.$message.error(t.msg))}).catch(function(t){console.log("err:",t),r.$message.error(t)})})},gen_list_cb:function(t,e){var r=this;if(!t||t.length<1)return this.cb_null;var s=t+"Data",n=t+"TotalRec",o=t+"TotalPage",i=t+"RecOfPage",a=t+"CurPage";return function(t){return e&&1==e&&t.data.cp>1?r[s]=r[s].concat(t.data.pageData||[]):r[s]=t.data.pageData||[],r[n]=t.data.totalRec,r[i]=t.data.rop,r[a]=t.data.cp,r[o]=t.data.rop>0?Math.ceil(t.data.totalRec/t.data.rop):0,t.data.detailData&&(r[s+"dData"]=t.data.detailData||[]),!0}},gen_selmulti_change:function(t){var e=this;if(!t||t.length<1)return this.cb_null;var r=t+"MultiSel";return function(t){if(e[r]){for(var s=[],n=0;n<t.length;n++)s.push(t[n].id);e[r]=s}}},refreshPage2:function(t,e,r,s,o,i){var a=t+"QueryArr",l=t+"CbPage",c=JSON.parse(n()(this[a]));if(c&&c.length>0)for(var u=c.length-1;u>-1;u--)console.log("qpsArr[i].val",c[u].val,0==c[u].val,""!=c[u].val),0==c[u].val&&(console.log("i:",u),c.splice(u,1));console.log("qpsArr:",c,this[a]);var h={qps:c||"",rop:r,cp:s};return this[t+"SortParas"]&&(h.sps=this[t+"SortParas"]),h._hy=o,this.callServer(e,h,[this.cb_success,this[l],i])},refreshPage:function(t,e,r,s){var n=t+"RecOfPage",o=t+"CurPage";this[o]<1&&(this[o]=1),this.refreshPage2(t,e,this[n],this[o],r,s)},queryPageData:function(t,e,r,s,o,i){if(!t||t.length<1)return this.cb_null;var a=t+"QueryArr",l=JSON.parse(n()(this[a]));if(l&&l.length>0)for(var c=l.length-1;c>-1;c--)0==l[c].val&&l.splice(c,1);console.log("qpsArr:",l);var u={qps:l||[],rop:r,cp:s};return this[t+"SortParas"]&&(u.sps=this[t+"SortParas"]),u._hy=o,this.callServer(e,u,i)}}}}}]);