(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3155"],{C59F:function(e,t,r){},WaL1:function(e,t,r){"use strict";var o=r("C59F");r.n(o).a},bHE8:function(e,t,r){"use strict";r.r(t);var o=r("P2sY"),n=r.n(o),a={name:"personedit",mixins:[r("y2a5").a],components:{},props:{paramsObj:{type:Object,default:function(){return{}}}},data:function(){return{newPersonForm:{id:0,org_id:0,name:"",post:"",idnumber:"",jobno:"",phone:"",gender:"",cardnum:0,uptime:(new Date).getTime(),image:""},personForm:{},orgDatas:[]}},mounted:function(){var e=this;this.pObj=n()({},this.paramsObj),this.gcomm.mapLength(this.pObj)>0?(this.isInDialog=!0,this.personForm=n()({},this.newPersonForm,this.pObj)):this.personForm=n()({},this.newPersonForm,this.$route.params);this.callSrvAct("/actq",{_hy:"departlist",qps:[{name:"stop",val:"t",op:"!="},{name:"type",val:"部门",op:"="}],sps:[{name:"sort",orderV:"asc"}],rop:1e3,cp:1}).then(function(t){e.orgDatas=t.data||[],console.log("test....",e.orgDatas)})},methods:{pObjChanged:function(){this.gcomm.mapLength(this.pObj)>0&&(this.isInDialog=!0,this.personForm=n()({},this.newPersonForm,this.pObj))},submitPersonFormImpl:function(e){var t=this,r=void 0,o="";this[e].id>0?(r="/act",!1,o="personup"):(r="/act",o="personadd");var a=n()({},this[e]);a._hy=o,this.callSrvAct(r,a).then(function(e){t.$router.go(-1)})},handleClick:function(e){var t=this;this.$refs[e].validate(function(r){if(!r)return!1;t.submitPersonFormImpl(e)}),console.log("结果",this.personForm)},handleReset:function(e){this.$refs[e].resetFields()},handleSuccess:function(e,t){console.log("res:",e),this.personForm.image=e.data},genDownUrl:function(e){if(!e||e.length<1)return"";var t=e.split(";");return!t||t.length<2?"":this.hysrvport+"/hydownload?btnEncode=headupload&relateType=headimage&filename="+t[1]+"&Authorization="+this.apiSrv.token},genUploadUrl:function(e){return this.hysrvport+"/hyupload?btnEncode=headupload&relateType=headimage&fi=add&Authorization="+this.apiSrv.token},beforeRemove:function(){},close:function(){this.personForm.image="",this.$refs.box.clearFiles()}},watch:{paramsObj:function(e){this.pObj.id!=this.paramsObj.id&&(this.pObj=n()({},this.paramsObj),this.pObjChanged())}},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},s=(r("WaL1"),r("KHd+")),i=Object(s.a)(a,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-container",{attrs:{direction:"vertical"}},[r("el-form",{ref:"personForm",attrs:{model:e.personForm,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"选择部门：",prop:"org_id"}},[r("el-select",{model:{value:e.personForm.org_id,callback:function(t){e.$set(e.personForm,"org_id",t)},expression:"personForm.org_id"}},e._l(e.orgDatas,function(e){return r("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"姓名：",prop:"name",rules:{required:!0}}},[r("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.personForm.name,callback:function(t){e.$set(e.personForm,"name",t)},expression:"personForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"岗位：",prop:"post",rules:{required:!0}}},[r("el-input",{attrs:{placeholder:"请输入岗位"},model:{value:e.personForm.post,callback:function(t){e.$set(e.personForm,"post",t)},expression:"personForm.post"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"身份证号：",prop:"idnumber",rules:{required:!0}}},[r("el-input",{attrs:{placeholder:"请输入身份证号"},model:{value:e.personForm.idnumber,callback:function(t){e.$set(e.personForm,"idnumber",t)},expression:"personForm.idnumber"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"工号：",prop:"jobno",rules:{required:!0}}},[r("el-input",{attrs:{placeholder:"请输入工号"},model:{value:e.personForm.jobno,callback:function(t){e.$set(e.personForm,"jobno",t)},expression:"personForm.jobno"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"手机号：",prop:"phone"}},[r("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.personForm.phone,callback:function(t){e.$set(e.personForm,"phone",t)},expression:"personForm.phone"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"性别：",prop:"gender",rules:{required:!0,max:12}}},[r("el-radio-group",{model:{value:e.personForm.gender,callback:function(t){e.$set(e.personForm,"gender",t)},expression:"personForm.gender"}},[r("el-radio",{attrs:{label:"m"}},[r("span",[e._v("男\n                        ")])]),e._v(" "),r("el-radio",{attrs:{label:"f"}},[r("span",[e._v("女\n                        ")])])],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"卡片数量：",prop:"cardnum",rules:{required:!0}}},[r("el-input-number",{attrs:{min:0,max:5,precision:0},model:{value:e.personForm.cardnum,callback:function(t){e.$set(e.personForm,"cardnum",t)},expression:"personForm.cardnum"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"最后修改时间：",prop:"uptime"}},[r("el-date-picker",{attrs:{"value-format":"timestamp",editable:!1,clearable:!1,type:"datetime","range-separator":"-"},model:{value:e.personForm.uptime,callback:function(t){e.$set(e.personForm,"uptime",t)},expression:"personForm.uptime"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"上传照片：",prop:"image"}},[r("el-upload",{ref:"box",staticStyle:{width:"178px",height:"178px",border:"1px dashed #d9d9d9","line-height":"178px","text-align":"center",position:"relative"},attrs:{action:e.genUploadUrl(),multiple:!1,"show-file-list":!1,"on-remove":e.beforeRemove,"on-success":e.handleSuccess,limit:1,id:"box"}},[e.personForm.image?r("img",{staticStyle:{width:"178px",height:"178px",display:"block"},attrs:{src:e.genDownUrl(e.personForm.image)}}):e._e(),e._v(" "),e.personForm.image?e._e():r("span",{staticStyle:{"font-size":"24px",color:"#7F7F7F","font-weight":"800"}},[r("i",{staticClass:"el-icon-plus"})]),e._v(" "),e.personForm.image?r("span",{ref:"clos",staticStyle:{position:"absolute",top:"0px",right:"0px"},attrs:{id:"clos"}},[r("i",{staticClass:"el-icon-close",staticStyle:{position:"absolute",top:"0px",right:"0px"},on:{click:function(t){return t.stopPropagation(),e.close(t)}}})]):e._e()])],1)],1),e._v(" "),r("div",{staticStyle:{display:"flex","margin-left":"120px"}},[r("el-button",{on:{click:function(t){e.handleClick("personForm")}}},[r("span",[e._v("提交\n            ")])]),e._v(" "),r("el-button",{staticStyle:{"margin-left":"40px"},on:{click:function(t){e.handleReset("personForm")}}},[r("span",[e._v("重置\n            ")])])],1)],1)},[],!1,null,"50e90a23",null);i.options.__file="index.vue";t.default=i.exports},y2a5:function(e,t,r){"use strict";var o=r("gDS+"),n=r.n(o),a=r("4d7F"),s=r.n(a);t.a={methods:{cb_null:function(e){return!1},cb_goBack:function(e){return this.$router.go(-1),!0},cb_success:function(e){return!(!e.status||"SUCCESS"!=e.status)||(this.$message.error(e.msg),!1)},cb_showMess:function(e){return this.$message.success(e.msg),!0},gen_sameValue:function(e,t){return function(r,o,n){o!=e?n(new Error(t)):n()}},refreshCaptcha:function(e){e.preventDefault(),e.target.src=this.hysrvport+"/captcha?"+Math.random()},add_authToken:function(e){return e.length<1?"":e=e.indexOf("?")>-1?e+"&Authorization="+this.apiSrv.token:e+"?Authorization="+this.apiSrv.token},callServer:function(e,t,r){var o=this;this.apiSrv.callServer(e,t).then(function(e){if(console.log("res ------",e),r)for(var t=0;t<r.length;t++){if(!r[t](e))break}}).catch(function(e){console.log("err:",e),o.$message.error(e)})},callSrvAct:function(e,t){var r=this;return new s.a(function(o,n){r.apiSrv.callServer(e,t).then(function(e){e.status&&"SUCCESS"==e.status?o(e):(console.log("res:",e),r.$message.error(e.msg))}).catch(function(e){console.log("err:",e),r.$message.error(e)})})},gen_list_cb:function(e,t){var r=this;if(!e||e.length<1)return this.cb_null;var o=e+"Data",n=e+"TotalRec",a=e+"TotalPage",s=e+"RecOfPage",i=e+"CurPage";return function(e){return t&&1==t&&e.data.cp>1?r[o]=r[o].concat(e.data.pageData||[]):r[o]=e.data.pageData||[],r[n]=e.data.totalRec,r[s]=e.data.rop,r[i]=e.data.cp,r[a]=e.data.rop>0?Math.ceil(e.data.totalRec/e.data.rop):0,e.data.detailData&&(r[o+"dData"]=e.data.detailData||[]),!0}},gen_selmulti_change:function(e){var t=this;if(!e||e.length<1)return this.cb_null;var r=e+"MultiSel";return function(e){if(t[r]){for(var o=[],n=0;n<e.length;n++)o.push(e[n].id);t[r]=o}}},refreshPage2:function(e,t,r,o,a){var s=e+"QueryArr",i=e+"CbPage",l=JSON.parse(n()(this[s]));if(l&&l.length>0)for(var p=l.length-1;p>-1;p--)console.log("qpsArr[i].val",l[p].val,0==l[p].val,""!=l[p].val),0==l[p].val&&(console.log("i:",p),l.splice(p,1));console.log("qpsArr:",l,this[s]);var c={qps:l||"",rop:r,cp:o};return this[e+"SortParas"]&&(c.sps=this[e+"SortParas"]),c._hy=a,this.callServer(t,c,[this.cb_success,this[i]])},refreshPage:function(e,t,r){var o=e+"RecOfPage",n=e+"CurPage";this[n]<1&&(this[n]=1),this.refreshPage2(e,t,this[o],this[n],r)},queryPageData:function(e,t,r,o,a){if(!e||e.length<1)return this.cb_null;var s=e+"QueryArr",i=JSON.parse(n()(this[s]));if(i&&i.length>0)for(var l=i.length-1;l>-1;l--)0==i[l].val&&i.splice(l,1);console.log("qpsArr:",i);var p={qps:i||[],rop:r,cp:o};return this[e+"SortParas"]&&(p.sps=this[e+"SortParas"]),this.callServer(t,p,a)}}}}}]);