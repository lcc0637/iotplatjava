(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3758"],{"RU/L":function(t,e,r){r("Rqdy");var n=r("WEpk").Object;t.exports=function(t,e,r){return n.defineProperty(t,e,r)}},Rqdy:function(t,e,r){var n=r("Y7ZC");n(n.S+n.F*!r("jmDH"),"Object",{defineProperty:r("2faE").f})},SEkw:function(t,e,r){t.exports={default:r("RU/L"),__esModule:!0}},YEIV:function(t,e,r){"use strict";e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(r("SEkw"));e.default=function(t,e,r){return e in t?(0,n.default)(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},ntYl:function(t,e,r){"use strict";r.r(e);var n=r("P2sY"),a=r.n(n),o=r("YEIV"),i=r.n(o),s=r("y2a5"),u=r("fZJM"),l=r.n(u),c={name:"login",mixins:[s.a],components:{},props:{paramsObj:{type:Object,default:function(){return{}}}},data:function(){var t;return t={newLoginForm:{id:0,userName:"",pwd:""},loginForm:{}},i()(t,"newLoginForm",{id:0,userName:"",pwd:"",salt:""}),i()(t,"passwordType","password"),i()(t,"randomImgSrc",this.hysrvport+"/captcha"),i()(t,"loading",!1),i()(t,"rnumber",""),t},mounted:function(){console.log(" -----1 "),this.pObj=a()({},this.paramsObj),this.gcomm.mapLength(this.pObj)>0?(this.isInDialog=!0,this.loginForm=a()({},this.newLoginForm,this.pObj)):this.loginForm=a()({},this.newLoginForm,this.$route.params),console.log(" ----- ")},methods:{pObjChanged:function(){this.gcomm.mapLength(this.pObj)>0&&(this.isInDialog=!0,this.loginForm=a()({},this.newLoginForm,this.pObj))},showPwd:function(){"password"===this.passwordType?this.passwordType="":this.passwordType="password"},refreshCaptcha:function(t){t.preventDefault(),t.target.src=this.hysrvport+"/captcha?"+Math.random()},handleLogin:function(){var t=this;this.$refs.loginForm.validate(function(e){if(!e)return!1;var r=l.a.sha1().update(t.loginForm.pwd).digest("hex"),n=new JSEncrypt;n.setPublicKey(t.apiSrv.getPubkey()),t.loginForm.salt=t.randomString(4),t.rnumber=t.randomString(4),console.log(t.loginForm.salt,t.rnumber);var o=t.loginForm.salt+","+t.rnumber+","+t.loginForm.userName+","+r,i=n.encrypt(o);t.callSrvAct("/login",i).then(function(e){if(e.status&&"SUCCESS"==e.status){e.Authorization&&e.Authorization.length>0&&t.apiSrv.setToken(e.Authorization),e.data.menuList&&e.data.menuList.length>0&&t.$router.addRoutes(t.$router.options.generateRoutes(e.data.menuList)),e.data.userInfo.user_name=t.loginForm.userName;var r=a()({},t.loginForm,e.data.userInfo),n=a()({},{userDetail:r},{org:e.data.org},{menuList:e.data.menuList});console.log("res xxx 4:",e.data.menuList),t.$store.dispatch("setUserInfo",n).then(function(){t.$router.push("/")})}})})},randomString:function(t){t=t||32;var e="1234567890".length,r="",n=0;for(n=0;n<t;n++)r+="1234567890".charAt(Math.floor(Math.random()*e));return r}},watch:{paramsObj:function(t){this.pObj.id!=this.paramsObj.id&&(this.pObj=a()({},this.paramsObj),this.pObjChanged())}},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},h=(r("qtIm"),r("KHd+")),p=Object(h.a)(c,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-container",{staticStyle:{"background-image":"url(/static/image/index.png)",width:"100%",height:"100%","background-size":"100% 100%"},attrs:{direction:"vertical"}},[r("div",{staticStyle:{width:"100%","margin-top":"170px"}},[r("div",{staticStyle:{width:"450px",margin:"0 auto","background-color":"#fff",padding:"20px","border-radius":"15px"}},[r("div",{staticStyle:{width:"100%","text-align":"center","padding-bottom":"10px","margin-bottom":"20px"}},[r("span",{staticStyle:{color:"#666666","font-weight":"bold","font-size":"24px"}},[t._v("工业物联网大数据平台\n                ")])]),t._v(" "),r("el-form",{ref:"loginForm",staticStyle:{"text-align":"center",width:"280px",margin:"0 auto"},attrs:{model:t.loginForm,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"账号：",prop:"userName",rules:{required:!0,message:"账号必填",trigger:"input"}}},[r("el-input",{attrs:{placeholder:"请输入账号"},model:{value:t.loginForm.userName,callback:function(e){t.$set(t.loginForm,"userName",e)},expression:"loginForm.userName"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"密码：",prop:"pwd",rules:{required:!0,message:"密码必填",trigger:"input"}}},[r("el-input",{attrs:{placeholder:"请输入密码",type:t.passwordType},model:{value:t.loginForm.pwd,callback:function(e){t.$set(t.loginForm,"pwd",e)},expression:"loginForm.pwd"}})],1),t._v(" "),r("el-form-item",{attrs:{prop:""}},[r("el-button",{staticStyle:{"background-color":"#169BD5",width:"100%"},attrs:{size:"medium"},on:{click:function(e){t.handleLogin()}}},[r("span",{staticStyle:{color:"#fff"}},[t._v("登录\n                            ")])])],1)],1)],1)])])},[],!1,null,"c1327ac8",null);p.options.__file="index.vue";e.default=p.exports},qtIm:function(t,e,r){"use strict";var n=r("tr9V");r.n(n).a},tr9V:function(t,e,r){},y2a5:function(t,e,r){"use strict";var n=r("gDS+"),a=r.n(n),o=r("4d7F"),i=r.n(o);e.a={methods:{cb_null:function(t){return!1},cb_goBack:function(t){return this.$router.go(-1),!0},cb_success:function(t){return!(!t.status||"SUCCESS"!=t.status)||(this.$message.error(t.msg),!1)},cb_showMess:function(t){return this.$message.success(t.msg),!0},gen_sameValue:function(t,e){return function(r,n,a){n!=t?a(new Error(e)):a()}},refreshCaptcha:function(t){t.preventDefault(),t.target.src=this.hysrvport+"/captcha?"+Math.random()},add_authToken:function(t){return t.length<1?"":t=t.indexOf("?")>-1?t+"&Authorization="+this.apiSrv.token:t+"?Authorization="+this.apiSrv.token},callServer:function(t,e,r){var n=this;this.apiSrv.callServer(t,e).then(function(t){if(console.log("res ------",t),r)for(var e=0;e<r.length;e++){if(!r[e](t))break}}).catch(function(t){console.log("err:",t),n.$message.error(t)})},callSrvAct:function(t,e){var r=this;return new i.a(function(n,a){r.apiSrv.callServer(t,e).then(function(t){t.status&&"SUCCESS"==t.status?n(t):(console.log("res:",t),r.$message.error(t.msg))}).catch(function(t){console.log("err:",t),r.$message.error(t)})})},gen_list_cb:function(t,e){var r=this;if(!t||t.length<1)return this.cb_null;var n=t+"Data",a=t+"TotalRec",o=t+"TotalPage",i=t+"RecOfPage",s=t+"CurPage";return function(t){return e&&1==e&&t.data.cp>1?r[n]=r[n].concat(t.data.pageData||[]):r[n]=t.data.pageData||[],r[a]=t.data.totalRec,r[i]=t.data.rop,r[s]=t.data.cp,r[o]=t.data.rop>0?Math.ceil(t.data.totalRec/t.data.rop):0,t.data.detailData&&(r[n+"dData"]=t.data.detailData||[]),!0}},gen_selmulti_change:function(t){var e=this;if(!t||t.length<1)return this.cb_null;var r=t+"MultiSel";return function(t){if(e[r]){for(var n=[],a=0;a<t.length;a++)n.push(t[a].id);e[r]=n}}},refreshPage2:function(t,e,r,n,o){var i=t+"QueryArr",s=t+"CbPage",u=JSON.parse(a()(this[i]));if(u&&u.length>0)for(var l=u.length-1;l>-1;l--)console.log("qpsArr[i].val",u[l].val,0==u[l].val,""!=u[l].val),0==u[l].val&&(console.log("i:",l),u.splice(l,1));console.log("qpsArr:",u,this[i]);var c={qps:u||"",rop:r,cp:n};return this[t+"SortParas"]&&(c.sps=this[t+"SortParas"]),c._hy=o,this.callServer(e,c,[this.cb_success,this[s]])},refreshPage:function(t,e,r){var n=t+"RecOfPage",a=t+"CurPage";this[a]<1&&(this[a]=1),this.refreshPage2(t,e,this[n],this[a],r)},queryPageData:function(t,e,r,n,o){if(!t||t.length<1)return this.cb_null;var i=t+"QueryArr",s=JSON.parse(a()(this[i]));if(s&&s.length>0)for(var u=s.length-1;u>-1;u--)0==s[u].val&&s.splice(u,1);console.log("qpsArr:",s);var l={qps:s||[],rop:r,cp:n};return this[t+"SortParas"]&&(l.sps=this[t+"SortParas"]),this.callServer(e,l,o)}}}}}]);