(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7dec"],{PrzN:function(t,e,a){},d037:function(t,e,a){"use strict";var n=a("PrzN");a.n(n).a},"pqQ+":function(t,e,a){"use strict";a.r(e);var n=a("P2sY"),r=a.n(n),o=a("EJiy"),s=a.n(o),i={name:"bulkimport",mixins:[a("y2a5").a],components:{},props:{},data:function(){return{importData:[],num:0,success:0,fail:0,repeat:0}},mounted:function(){},methods:{importfxx:function(t){var e=this;e.num=0,e.success=0,e.fail=0,e.repeat=0,console.log(this.$refs.upload.value),this.file=event.currentTarget.files[0],console.log(this.file);var a=this.file,n=new FileReader;FileReader.prototype.readAsBinaryString=function(t){var a,n,r="";window.console.log(this);var o=new FileReader;o.onload=function(t){window.console.log(t);for(var s=new Uint8Array(o.result),i=s.byteLength,l=0;l<i;l++)r+=String.fromCharCode(s[l]);a=XLSX.read(r,{type:"binary"}),n=XLSX.utils.sheet_to_json(a.Sheets[a.SheetNames[0]]),window.console.log(n);for(var c=[],u=0;u<n.length;u++)c.push({title:n[u].设备名称,region_title:n[u].摄像机位置,videoa:n[u].视频地址,state:n[u].状态,algorithms:n[u].算法,resolution:n[u].分辨率,framerate:n[u].帧率,corp:n[u].厂商});window.console.log(c),e.importData=c,console.log(e.$refs.upload.value),console.log(document.getElementById("upload").value)},o.readAsArrayBuffer(t)},n.readAsBinaryString(a)},fixdata:function(t){for(var e="",a=0,n=10240;a<t.byteLength/n;++a)e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(a*n,a*n+n)));return e+=String.fromCharCode.apply(null,new Uint8Array(t.slice(a*n)))},SizeChange:function(){},CurChange:function(){},exportExcel:function(){this.num=0,this.success=0,this.fail=0,this.repeat=0;var t=XLSX.utils.json_to_sheet([{"设备名称":"","摄像机位置":"","视频地址":"","状态":"","算法":"","分辨率":"","帧率":"","厂商":""}]);console.log(t),this.openDownloadDialog(this.sheet2blob(t),"模板教程.xlsx")},sheet2blob:function(t,e){var a={SheetNames:[e=e||"sheet1"],Sheets:{}};a.Sheets[e]=t;var n=XLSX.write(a,{bookType:"xlsx",bookSST:!1,type:"binary"});return new Blob([function(t){for(var e=new ArrayBuffer(t.length),a=new Uint8Array(e),n=0;n!=t.length;++n)a[n]=255&t.charCodeAt(n);return e}(n)],{type:"application/octet-stream"})},openDownloadDialog:function(t,e){"object"==(void 0===t?"undefined":s()(t))&&t instanceof Blob&&(t=URL.createObjectURL(t));var a,n=document.createElement("a");n.href=t,n.download=e||"",window.MouseEvent?a=new MouseEvent("click"):(a=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(a)},uploadOk:function(){var t=this;this.num=0,this.success=0,this.fail=0,this.repeat=0,this.num=this.importData.length,console.log("上传数据",this.importData);for(var e=0;e<this.importData.length;e++){this.importData[e].pos="",this.importData[e].url="",this.importData[e].scene="",this.importData[e].algorithms="",this.importData[e].codec="";var a=r()({},this.importData[e]);a._hy="cameraadd",this.callSrvAct("/act",a).then(function(e){console.log("后台返回",e),"SUCCESS"==e.status?t.success=t.success+1:"FAILED"==e.status&&(t.fail=t.fail+1)})}}},watch:{},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},l=(a("d037"),a("KHd+")),c=Object(l.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{attrs:{direction:"vertical"}},[a("el-row",{attrs:{autogenchild:!1,childcol:24}},[a("span",[t._v("提示：需保证上传的excel文件为单一文件\n        ")])]),t._v(" "),a("div",{staticStyle:{margin:"10px 0px"}},[a("span",[t._v("请先\n        ")]),t._v(" "),a("el-button",{on:{click:t.exportExcel}},[a("span",[t._v("下载模板和教程\n            ")])]),t._v(" "),a("span",[t._v("仔细阅读后，按要求填写车辆信息，并上传摄像机信息表格\n        ")])],1),t._v(" "),a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",{staticStyle:{display:"flex",height:"36px","line-height":"35px"}},[a("span",[t._v("上传的文件：\n            ")]),t._v(" "),a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"文件路径"}}),t._v(" "),a("el-input",{ref:"upload",attrs:{type:"file",id:"upload"},on:{change:function(e){t.importfxx(this)}}}),t._v(" "),a("el-button",{on:{click:t.uploadOk}},[a("span",[t._v("确认上传\n                ")])])],1),t._v(" "),a("div",[a("span",[t._v("上传共\n            ")]),t._v(" "),a("span",[t._v(t._s(t.num)+"\n            ")]),t._v(" "),a("span",[t._v("条  成功\n            ")]),t._v(" "),a("span",{staticStyle:{color:"green"}},[t._v(t._s(t.success)+"\n            ")]),t._v(" "),a("span",{staticStyle:{color:"green"}},[t._v("条\n            ")]),t._v(" "),a("span",[t._v("失败\n            ")]),t._v(" "),a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.fail)+"\n            ")]),t._v(" "),a("span",{staticStyle:{color:"red"}},[t._v("条\n            ")]),t._v(" "),a("span",[t._v("重复\n            ")]),t._v(" "),a("span",{staticStyle:{color:"blue"}},[t._v(t._s(t.repeat)+"\n            ")]),t._v(" "),a("span",{staticStyle:{color:"blue"}},[t._v("条\n            ")])])]),t._v(" "),a("el-table",{attrs:{data:t.importData,"header-cell-style":{background:"rgba(241,246,254,1)",fontWeight:"500",color:"#333333",fontSize:"16px","text-align":"center"}}},[a("el-table-column",{attrs:{label:"设备名称",prop:"title"}}),t._v(" "),a("el-table-column",{attrs:{label:"摄像机位置",prop:"region_title"}}),t._v(" "),a("el-table-column",{attrs:{label:"视频地址",prop:"videoa"}}),t._v(" "),a("el-table-column",{attrs:{label:"分辨率",prop:"resolution"}}),t._v(" "),a("el-table-column",{attrs:{label:"帧率",prop:"framerate"}}),t._v(" "),a("el-table-column",{attrs:{label:"厂商",prop:"corp"}}),t._v(" "),a("el-table-column",{attrs:{label:"状态",prop:"state"}})],1)],1)},[],!1,null,"d870c432",null);c.options.__file="index.vue";e.default=c.exports},y2a5:function(t,e,a){"use strict";var n=a("gDS+"),r=a.n(n),o=a("4d7F"),s=a.n(o);e.a={methods:{cb_null:function(t){return!1},cb_goBack:function(t){return this.$router.go(-1),!0},cb_success:function(t){return!(!t.status||"SUCCESS"!=t.status)||(this.$message.error(t.msg),!1)},cb_showMess:function(t){return this.$message.success(t.msg),!0},gen_sameValue:function(t,e){return function(a,n,r){n!=t?r(new Error(e)):r()}},refreshCaptcha:function(t){t.preventDefault(),t.target.src=this.hysrvport+"/captcha?"+Math.random()},add_authToken:function(t){return t.length<1?"":t=t.indexOf("?")>-1?t+"&Authorization="+this.apiSrv.token:t+"?Authorization="+this.apiSrv.token},callServer:function(t,e,a){var n=this;this.apiSrv.callServer(t,e).then(function(t){if(console.log("res ------",t),a)for(var e=0;e<a.length;e++){if(!a[e](t))break}}).catch(function(t){console.log("err:",t),n.$message.error(t)})},callSrvAct:function(t,e){var a=this;return new s.a(function(n,r){a.apiSrv.callServer(t,e).then(function(t){t.status&&"SUCCESS"==t.status?n(t):(console.log("res:",t),a.$message.error(t.msg))}).catch(function(t){console.log("err:",t),a.$message.error(t)})})},gen_list_cb:function(t,e){var a=this;if(!t||t.length<1)return this.cb_null;var n=t+"Data",r=t+"TotalRec",o=t+"TotalPage",s=t+"RecOfPage",i=t+"CurPage";return function(t){return e&&1==e&&t.data.cp>1?a[n]=a[n].concat(t.data.pageData||[]):a[n]=t.data.pageData||[],a[r]=t.data.totalRec,a[s]=t.data.rop,a[i]=t.data.cp,a[o]=t.data.rop>0?Math.ceil(t.data.totalRec/t.data.rop):0,t.data.detailData&&(a[n+"dData"]=t.data.detailData||[]),!0}},gen_selmulti_change:function(t){var e=this;if(!t||t.length<1)return this.cb_null;var a=t+"MultiSel";return function(t){if(e[a]){for(var n=[],r=0;r<t.length;r++)n.push(t[r].id);e[a]=n}}},refreshPage2:function(t,e,a,n,o){var s=t+"QueryArr",i=t+"CbPage",l=JSON.parse(r()(this[s]));if(l&&l.length>0)for(var c=l.length-1;c>-1;c--)console.log("qpsArr[i].val",l[c].val,0==l[c].val,""!=l[c].val),0==l[c].val&&(console.log("i:",c),l.splice(c,1));console.log("qpsArr:",l,this[s]);var u={qps:l||"",rop:a,cp:n};return this[t+"SortParas"]&&(u.sps=this[t+"SortParas"]),u._hy=o,this.callServer(e,u,[this.cb_success,this[i]])},refreshPage:function(t,e,a){var n=t+"RecOfPage",r=t+"CurPage";this[r]<1&&(this[r]=1),this.refreshPage2(t,e,this[n],this[r],a)},queryPageData:function(t,e,a,n,o){if(!t||t.length<1)return this.cb_null;var s=t+"QueryArr",i=JSON.parse(r()(this[s]));if(i&&i.length>0)for(var l=i.length-1;l>-1;l--)0==i[l].val&&i.splice(l,1);console.log("qpsArr:",i);var c={qps:i||[],rop:a,cp:n};return this[t+"SortParas"]&&(c.sps=this[t+"SortParas"]),this.callServer(e,c,o)}}}}}]);