(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3fd8","chunk-1067"],{AcGF:function(e,t,n){"use strict";var i=n("tT9J");n.n(i).a},"RU/L":function(e,t,n){n("Rqdy");var i=n("WEpk").Object;e.exports=function(e,t,n){return i.defineProperty(e,t,n)}},Rqdy:function(e,t,n){var i=n("Y7ZC");i(i.S+i.F*!n("jmDH"),"Object",{defineProperty:n("2faE").f})},SEkw:function(e,t,n){e.exports={default:n("RU/L"),__esModule:!0}},SoS4:function(e,t,n){"use strict";n.r(t);var i=n("P2sY"),r=n.n(i),o={name:"regionedit",mixins:[n("y2a5").a],components:{},props:{paramsObj:{type:Object,default:function(){return{}}}},data:function(){return{newRegionForm:{id:0,title:"",parent_id:0},regionForm:{},isInDialog:!1}},mounted:function(){this.pObj=r()({},this.paramsObj),this.gcomm.mapLength(this.pObj)>0?(this.isInDialog=!0,this.regionForm=r()({},this.newRegionForm,this.pObj)):this.regionForm=r()({},this.newRegionForm,this.$route.params),console.log("123",this.paramsObj)},methods:{pObjChanged:function(){this.gcomm.mapLength(this.pObj)>0&&(this.isInDialog=!0,this.regionForm=r()({},this.newRegionForm,this.pObj))},submit:function(){this.submitOrgForm("regionForm")},submitOrgFormImpl:function(e){var t=this,n=void 0,i=!0,o="";this[e].id>0?(n="/act",i=!1,o="regionup"):(n="/act",o="regionadd");var a=r()({},this[e]);a._hy=o,this.callSrvAct(n,a).then(function(e){t.isInDialog?(console.log("不跳转"),i?e.data&&e.data.inst?(console.log("1111111111"),t.$emit("submitOk",e.data.inst)):e.data&&(console.log("22222222222"),t.$emit("submitOk",e.data||{})):t.$emit("submitOk",a)):(console.log("跳转"),t.$router.go(-1))})},submitOrgForm:function(e){var t=this;this.$refs[e].validate(function(n){if(!n)return!1;t.submitOrgFormImpl(e)})}},watch:{paramsObj:function(e){this.pObj.id!=this.paramsObj.id&&(this.pObj=r()({},this.paramsObj),this.pObjChanged())}},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},a=(n("cJ8U"),n("KHd+")),s=Object(a.a)(o,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{attrs:{direction:"vertical"}},[n("el-form",{ref:"regionForm",attrs:{model:e.regionForm,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"区域名称：",prop:"title"}},[n("el-input",{model:{value:e.regionForm.title,callback:function(t){e.$set(e.regionForm,"title",t)},expression:"regionForm.title"}})],1),e._v(" "),e._e()],1),e._v(" "),n("div",{staticStyle:{"text-align":"center"}},[n("el-button",{staticStyle:{"background-color":"#317EF3"},on:{click:e.submit}},[n("span",{staticStyle:{color:"#ffffff"}},[e._v("提交\n                ")])])],1)],1)},[],!1,null,"6924530a",null);s.options.__file="index.vue";t.default=s.exports},YEIV:function(e,t,n){"use strict";t.__esModule=!0;var i=function(e){return e&&e.__esModule?e:{default:e}}(n("SEkw"));t.default=function(e,t,n){return t in e?(0,i.default)(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},cJ8U:function(e,t,n){"use strict";var i=n("gH9h");n.n(i).a},gH9h:function(e,t,n){},tT9J:function(e,t,n){},y2a5:function(e,t,n){"use strict";var i=n("gDS+"),r=n.n(i),o=n("4d7F"),a=n.n(o);t.a={methods:{cb_null:function(e){return!1},cb_goBack:function(e){return this.$router.go(-1),!0},cb_success:function(e){return!(!e.status||"SUCCESS"!=e.status)||(this.$message.error(e.msg),!1)},cb_showMess:function(e){return this.$message.success(e.msg),!0},gen_sameValue:function(e,t){return function(n,i,r){i!=e?r(new Error(t)):r()}},refreshCaptcha:function(e){e.preventDefault(),e.target.src=this.hysrvport+"/captcha?"+Math.random()},add_authToken:function(e){return e.length<1?"":e=e.indexOf("?")>-1?e+"&Authorization="+this.apiSrv.token:e+"?Authorization="+this.apiSrv.token},callServer:function(e,t,n){var i=this;this.apiSrv.callServer(e,t).then(function(e){if(console.log("res ------",e),n)for(var t=0;t<n.length;t++){if(!n[t](e))break}}).catch(function(e){console.log("err:",e),i.$message.error(e)})},callSrvAct:function(e,t){var n=this;return new a.a(function(i,r){n.apiSrv.callServer(e,t).then(function(e){e.status&&"SUCCESS"==e.status?i(e):(console.log("res:",e),n.$message.error(e.msg))}).catch(function(e){console.log("err:",e),n.$message.error(e)})})},gen_list_cb:function(e,t){var n=this;if(!e||e.length<1)return this.cb_null;var i=e+"Data",r=e+"TotalRec",o=e+"TotalPage",a=e+"RecOfPage",s=e+"CurPage";return function(e){return t&&1==t&&e.data.cp>1?n[i]=n[i].concat(e.data.pageData||[]):n[i]=e.data.pageData||[],n[r]=e.data.totalRec,n[a]=e.data.rop,n[s]=e.data.cp,n[o]=e.data.rop>0?Math.ceil(e.data.totalRec/e.data.rop):0,e.data.detailData&&(n[i+"dData"]=e.data.detailData||[]),!0}},gen_selmulti_change:function(e){var t=this;if(!e||e.length<1)return this.cb_null;var n=e+"MultiSel";return function(e){if(t[n]){for(var i=[],r=0;r<e.length;r++)i.push(e[r].id);t[n]=i}}},refreshPage2:function(e,t,n,i,o){var a=e+"QueryArr",s=e+"CbPage",l=JSON.parse(r()(this[a]));if(l&&l.length>0)for(var c=l.length-1;c>-1;c--)console.log("qpsArr[i].val",l[c].val,0==l[c].val,""!=l[c].val),0==l[c].val&&(console.log("i:",c),l.splice(c,1));console.log("qpsArr:",l,this[a]);var h={qps:l||"",rop:n,cp:i};return this[e+"SortParas"]&&(h.sps=this[e+"SortParas"]),h._hy=o,this.callServer(t,h,[this.cb_success,this[s]])},refreshPage:function(e,t,n){var i=e+"RecOfPage",r=e+"CurPage";this[r]<1&&(this[r]=1),this.refreshPage2(e,t,this[i],this[r],n)},queryPageData:function(e,t,n,i,o){if(!e||e.length<1)return this.cb_null;var a=e+"QueryArr",s=JSON.parse(r()(this[a]));if(s&&s.length>0)for(var l=s.length-1;l>-1;l--)0==s[l].val&&s.splice(l,1);console.log("qpsArr:",s);var c={qps:s||[],rop:n,cp:i};return this[e+"SortParas"]&&(c.sps=this[e+"SortParas"]),this.callServer(t,c,o)}}}},zzde:function(e,t,n){"use strict";n.r(t);var i=n("m1cH"),r=n.n(i),o=n("gDS+"),a=n.n(o),s=n("YEIV"),l=n.n(s),c=n("SoS4"),h={name:"rmanage",mixins:[n("y2a5").a],components:l()({Regionedit:c.default},"Regionedit",c.default),props:{},data:function(){return l()({show:!1,regioneInstEdit:null,regionQueryArr:[{name:"title",val:"",op:"like"}],regionSortParas:[{name:"title",orderV:"asc"}],regioneTtData:[{hy_extra_num:2,id:0,parent_id:0,title:"xxxx有限公司",children:[],isLeaf:!1}]},"show",!1)},mounted:function(){this.getOrgTtData(0)},methods:{search:function(){this.getOrgTtData(0)},add:function(){var e=this.$refs.regione.getCheckedKeys();!e||e.length<1?this.regioneInstEdit={id:0,title:"",parent_id:0}:this.regioneInstEdit={id:0,title:"",parent_id:e[0]},console.log("传的参数",this.regioneInstEdit),this.show=!0},del:function(){var e=this,t=this.$refs.regione.getCheckedKeys();!t||t.length<1||0!=t[0]&&this.$confirm("确认删除？此区域下的子区域将会一并删除","删除区域",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("delIds--------------------");var n=[],i=e.findOrgItem(e.regioneTtData,t[0]);if(i){n.push(i.id);for(var r=[],o=(e.getChildId(i.children,r),0);o<r.length;o++)n.indexOf(r[o])<0&&n.push(r[o])}if(console.log("delIds",n),n&&n.length>0){console.log("delIds 2");var a={_hy:"regiondel",region:[{name:"id",val:n,op:"in"}]};e.callSrvAct("/act",a).then(function(t){console.log("delIds 3",t),e.$refs.regione.remove(n[0])})}}).catch(function(e){})},getChildId:function(e,t){if(!e||e.length<1)return t;for(var n=0;n<e.length;n++)t.push(e[n].id);for(var i=0;i<e.length;i++)e[i]&&e[i].children&&e[i].children.length>0&&this.getChildId(e[i].children,t);return t},delregiones:function(){var e=this,t=this.$refs.regione.getCheckedKeys();!t||t.length<1||this.$confirm("确认删除？此区域下的子区域将会一并删除","删除区域",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var n=[],i=0;i<t.length;i++)if(0!=t[0]&&n.indexOf(t[i])<0){n.push(t[i]);var r=e.findOrgItem(e.regioneTtData,t[i]);if(r)for(var o=[],a=(e.getChildId(r.children,o),0);a<o.length;a++)n.indexOf(o[a])<0&&n.push(o[a])}if(console.log("delIds",n),n&&n.length>0){console.log("delIds 2");var s={_hy:"regiondel",region:[{name:"id",val:n,op:"in"}]};e.callSrvAct("/act",s).then(function(t){console.log("delIds 3",t);for(var i=0;i<n.length;i++)e.$refs.regione.remove(n[i])})}}).catch(function(e){})},setObjInParentArr:function(e,t){var n=!1;console.log("setObjInParentArr: ----1");for(var i=0;i<e.length;i++)if(console.log("setObjInParentArr: ----12"),e[i].title>t.title){var r=e[i];e.splice(i,1,t,r),n=!0;break}console.log("setObjInParentArr: ----22"),n||e.push(t),console.log("setObjInParentArr: ----3")},rmObjFromParentArr:function(e,t){if(e&&!(e.length<1)&&t)for(var n=0;n<e.length;n++)if(e[n].id==t.id)return void e.splice(n,1)},setOrgItem:function(e,t){console.log("setPageItem: ----1",t);var n=this.findOrgItem(e,t.id);if(console.log("oldObj:",n),n)if(n.parent_id>0){var i=this.findOrgItem(this.regioneTtData,n.parent_id);console.log("oldObjParent:",i),i&&(this.rmObjFromParentArr(i.children,n),i.hy_extra_num=i.children.length+1,i.isLeaf=i.hy_extra_num>1)}else this.rmObjFromParentArr(this.regioneTtData[0].children,n);if(console.log("setPageItem: ----2"),t.parent_id<1)return console.log("setPageItem: ----3"),void this.setObjInParentArr(this.regioneTtData[0].children,t);console.log("setPageItem: ----4");var r=this.findOrgItem(this.regioneTtData,t.parent_id);r&&(console.log("setPageItem: ----5"),this.setObjInParentArr(r.children,t),r.hy_extra_num=r.children.length+1,r.isLeaf=r.hy_extra_num>1),console.log("setPageItem: ----6")},regioneditOK:function(e,t){this.setOrgItem(this.regioneTtData,e),this.regioneInstEdit={},this.show=!1},regioneditSet:function(){},up:function(){var e=this.$refs.regione.getCheckedKeys();if(e&&!(e.length<1)){var t=this.findOrgItem(this.regioneTtData,e[0]);t&&(this.regioneInstEdit=JSON.parse(a()(t)),this.show=!0)}},close:function(){this.show=!1},clickTreeItem:function(e,t){if(console.log("node:",e,t),!(e.id<1)){var n=this.$refs.regione.getCheckedKeys();n&&n.indexOf(e.id)>-1?this.$refs.regione.setChecked(e.id,!1,!1):this.$refs.regione.setChecked(e.id,!0,!1),e.hy_extra_num>1&&(!e.children||e.children.length<1)&&this.getOrgTtData(e.id,t)}},regioneTreeCheck:function(e,t){if(e.hy_extra_num>1&&(!e.children||e.children.length<1)){var n=this.$refs.regione.getNode(e.id);n&&this.getOrgTtData(e.id,n)}},getOrgTtData:function(e,t){var n=this,i=JSON.parse(a()(this.regionQueryArr));console.log("queryParas",i),e>0?i.push({name:"parent_id",val:e}):this.regioneTtData=[{hy_extra_num:2,id:0,parent_id:0,title:"xxxx有限公司",children:[],isLeaf:!1}];var r={_hy:"regiontt",qps:i,sps:this.regionSortParas};this.callSrvAct("/actq",r).then(function(i){var r=i.data||[];console.log("获取到的数据",r);for(var o=0;o<r.length;o++)r[o].isLeaf=r[o].hy_extra_num>1,r[o].children=[];n.appendData(e,r),t&&(t.expanded=!0)})},findOrgItem:function(e,t){if(!e||e.length<1)return null;for(var n=0;n<e.length;n++)if(console.log("arr,",n,e[n].id,t,e[n].id==t),e[n].id==t)return e[n];for(var i=0;i<e.length;i++)if(e[i].children&&e[i].children.length>0){var r=this.findOrgItem(e[i].children,t);if(r)return r}return null},appendData:function(e,t){if(e<1){var n;t&&t.length>0&&((n=this.regioneTtData[0].children).push.apply(n,r()(t)),this.regioneTtData[0].hy_extra_num=this.regioneTtData[0].children.length+1)}else{var i=this.findOrgItem(this.regioneTtData,e);console.log("parentItem:",i,e),i&&(i.children=t||[],i.hy_extra_num=i.children.length+1)}}},watch:{},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},u=(n("AcGF"),n("KHd+")),g=Object(u.a)(h,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{attrs:{direction:"vertical"}},[n("div",{staticStyle:{display:"flex",height:"40px","line-height":"40px"}},[n("span",{staticStyle:{display:"block"}},[e._v("区域\n        ")]),e._v(" "),n("el-input",{staticStyle:{margin:"0px 10px",width:"150px"},model:{value:e.regionQueryArr[0].val,callback:function(t){e.$set(e.regionQueryArr[0],"val",t)},expression:"regionQueryArr[0].val"}}),e._v(" "),n("el-button",{on:{click:e.search}},[n("span",[e._v("搜索\n            ")])])],1),e._v(" "),n("div",{staticStyle:{margin:"20px 0px"}},[n("el-button",{on:{click:e.add}},[n("span",[e._v("新增\n            ")])]),e._v(" "),n("el-button",{on:{click:e.up}},[n("span",[e._v("修改\n            ")])]),e._v(" "),n("el-button",{on:{click:e.del}},[n("span",[e._v("删除\n            ")])]),e._v(" "),n("el-button",{on:{click:e.delregiones}},[n("span",[e._v("批量删除\n            ")])])],1),e._v(" "),n("el-tree",{ref:"regione",staticStyle:{"overflow-y":"auto",height:"300px"},attrs:{"node-key":"id",props:{label:"title",disabled:!1,isLeaf:!0,children:"children"},"highlight-current":!0,"show-checkbox":!0,"check-strictly":!0,data:e.regioneTtData},on:{click:e.regioneTreeCheck,"node-click":e.clickTreeItem}}),e._v(" "),n("el-dialog",{attrs:{visible:e.show,title:"区域编辑","append-to-body":!0,close:e.close},on:{"update:visible":function(t){e.show=t}}},[n("regionedit",{attrs:{paramsObj:e.regioneInstEdit},on:{submitOk:e.regioneditOK,submitClose:e.regioneditSet}})],1)],1)},[],!1,null,"cbc00f60",null);g.options.__file="index.vue";t.default=g.exports}}]);