(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0e35","chunk-f242"],{"133e":function(t,e,r){},"55c2":function(t,e,r){"use strict";var n=r("133e");r.n(n).a},"6O6q":function(t,e,r){"use strict";var n=r("pp65");r.n(n).a},"Qpg+":function(t,e,r){"use strict";r.r(e);var n=r("m1cH"),i=r.n(n),o=r("gDS+"),a=r.n(o),s=r("y2a5"),l=r("U+t5"),c={name:"orgtreetable",mixins:[s.a],components:{Orgedit:l.default},data:function(){return{orgstatus:[{label:"正常",val:"f"},{label:"停用",val:"t"}],orgQueryInit:[{name:"title",val:"",op:"like"},{name:"type",val:"部门",op:"="},{name:"stop",val:"f",op:"like"}],orgQueryArr:[{name:"title",val:"",op:"like"},{name:"type",val:"部门",op:"="},{name:"stop",val:"f",op:"like"}],orgSortParas:[{name:"id",orderV:"asc"}],orgTtData:[{hy_extra_num:2,id:0,parent_id:0,title:"xxxx有限公司",type:"部门",children:[],isLeaf:!1}],showEditOrgSet:!1,orgInstEdit:null}},mounted:function(){console.log("kdkdk ----",l.default),this.getOrgTtData(0)},methods:{searchOrg:function(){this.getOrgTtData(0)},delOrg:function(){var t=this,e=this.$refs.org.getCheckedKeys();!e||e.length<1||0!=e[0]&&this.$confirm("确认删除？此部门下的子部门将会一并删除","删除部门",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("delIds--------------------");var r=[],n=t.findOrgItem(t.orgTtData,e[0]);if(n){r.push(n.id);for(var i=[],o=(t.getChildId(n.children,i),0);o<i.length;o++)r.indexOf(i[o])<0&&r.push(i[o])}if(console.log("delIds",r),r&&r.length>0){console.log("delIds 2");var a={_hy:"orgdel",org:[{name:"id",val:r,op:"in"}]};t.callSrvAct("/act",a).then(function(e){console.log("delIds 3",e),t.$refs.org.remove(r[0])})}}).catch(function(t){})},getChildId:function(t,e){if(!t||t.length<1)return e;for(var r=0;r<t.length;r++)e.push(t[r].id);for(var n=0;n<t.length;n++)t[n]&&t[n].children&&t[n].children.length>0&&this.getChildId(t[n].children,e);return e},delOrgs:function(){var t=this,e=this.$refs.org.getCheckedKeys();!e||e.length<1||this.$confirm("确认删除？此部门下的子部门将会一并删除","删除部门",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var r=[],n=0;n<e.length;n++)if(0!=e[0]&&r.indexOf(e[n])<0){r.push(e[n]);var i=t.findOrgItem(t.orgTtData,e[n]);if(i)for(var o=[],a=(t.getChildId(i.children,o),0);a<o.length;a++)r.indexOf(o[a])<0&&r.push(o[a])}if(console.log("delIds",r),r&&r.length>0){console.log("delIds 2");var s={_hy:"orgdel",org:[{name:"id",val:r,op:"in"}]};t.callSrvAct("/act",s).then(function(e){console.log("delIds 3",e);for(var n=0;n<r.length;n++)t.$refs.org.remove(r[n])})}}).catch(function(t){})},setObjInParentArr:function(t,e){var r=!1;if(t&&!(t.length<1)){console.log("setObjInParentArr: ----1");for(var n=0;n<t.length;n++)if(console.log("setObjInParentArr: ----12"),t[n].title>e.title){var i=t[n];t.splice(n,1,e,i),r=!0;break}console.log("setObjInParentArr: ----22"),r||t.push(e),console.log("setObjInParentArr: ----3")}},rmObjFromParentArr:function(t,e){if(t&&!(t.length<1)&&e)for(var r=0;r<t.length;r++)if(t[r].id==e.id)return void t.splice(r,1)},setOrgItem:function(t,e){console.log("setPageItem: ----1",e);var r=this.findOrgItem(t,e.id);if(console.log("oldObj:",r),r)if(r.parent_id>0){var n=this.findOrgItem(this.orgTtData,r.parent_id);console.log("oldObjParent:",n),n&&(this.rmObjFromParentArr(n.children,r),n.hy_extra_num=n.children.length+1,n.isLeaf=n.hy_extra_num>1)}else this.rmObjFromParentArr(this.orgTtData[0].children,r);if(console.log("setPageItem: ----2"),e.parent_id<1)return console.log("setPageItem: ----3"),void this.setObjInParentArr(this.orgTtData[0].children,e);console.log("setPageItem: ----4");var i=this.findOrgItem(this.orgTtData,e.parent_id);i&&(console.log("setPageItem: ----5"),this.setObjInParentArr(i.children,e),i.hy_extra_num=i.children.length+1,i.isLeaf=i.hy_extra_num>1),console.log("setPageItem: ----6")},editOrgSetOK:function(t,e){console.log("evt:",t,e),this.setOrgItem(this.orgTtData,t),this.orgInstEdit={},this.showEditOrgSet=!1},editOrgSet:function(){var t=this.$refs.org.getCheckedKeys();if(t&&!(t.length<1)){var e=this.findOrgItem(this.orgTtData,t[0]);e&&(this.orgInstEdit=JSON.parse(a()(e)),this.showEditOrgSet=!0)}},addNewOrg:function(){var t=this.$refs.org.getCheckedKeys();!t||t.length<1?this.orgInstEdit={id:0,title:"",type:"部门",parent_id:0,sort:0,data_scope:"f",stop:"f",memo:""}:this.orgInstEdit={id:0,title:"",type:"部门",parent_id:t[0],sort:0,data_scope:"f",stop:"f",memo:""},console.log("this.orgInstEdit:",this.orgInstEdit),this.showEditOrgSet=!0},orgTreeCheck:function(t,e){if(console.log("data:",t),t.hy_extra_num>1&&(!t.children||t.children.length<1)){var r=this.$refs.org.getNode(t.id);r&&this.getOrgTtData(t.id,r)}},clickTreeItem:function(t,e){if(console.log("node:",t),t.hy_extra_num>1&&(!t.children||t.children.length<1))this.getOrgTtData(t.id,e);else{if(t.id<1)return;var r=this.$refs.org.getCheckedKeys();r&&r.indexOf(t.id)>-1?this.$refs.org.setChecked(t.id,!1,!1):this.$refs.org.setChecked(t.id,!0,!1)}},findOrgItem:function(t,e){if(!t||t.length<1)return null;for(var r=0;r<t.length;r++)if(console.log("arr,",r,t[r].id,e,t[r].id==e),t[r].id==e)return t[r];for(var n=0;n<t.length;n++)if(t[n].children&&t[n].children.length>0){var i=this.findOrgItem(t[n].children,e);if(i)return i}return null},appendData:function(t,e){if(t<1){var r;e&&e.length>0&&((r=this.orgTtData[0].children).push.apply(r,i()(e)),this.orgTtData[0].hy_extra_num=this.orgTtData[0].children.length+1)}else{var n=this.findOrgItem(this.orgTtData,t);n&&(n.children=e||[],n.hy_extra_num=n.children.length+1)}},getOrgTtData:function(t,e){var r=this,n=JSON.parse(a()(this.orgQueryArr));t>0?n.push({name:"parent_id",val:t}):this.orgTtData=[{hy_extra_num:2,id:0,parent_id:0,title:"xxxx有限公司",type:"部门",children:[],isLeaf:!1}];var i={_hy:"orgtt",qps:n,sps:this.orgSortParas};this.callSrvAct("/actq",i).then(function(n){for(var i=n.data||[],o=0;o<i.length;o++)i[o].isLeaf=i[o].hy_extra_num>1,i[o].children=[];r.appendData(t,i),e&&(e.expanded=!0)})}}},h=(r("6O6q"),r("KHd+")),g=Object(h.a)(c,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-container",{attrs:{direction:"vertical"}},[r("el-container",{staticStyle:{height:"40px"},attrs:{direction:"horizontal"}},[r("el-input",{staticStyle:{"margin-right":"10px"},attrs:{placeholder:"部门名称"},model:{value:t.orgQueryArr[0].val,callback:function(e){t.$set(t.orgQueryArr[0],"val",e)},expression:"orgQueryArr[0].val"}}),t._v(" "),r("el-button",{on:{click:t.searchOrg}},[r("span",[t._v("搜索\n            ")])]),t._v(" "),r("el-button",{on:{click:t.addNewOrg}},[r("span",[t._v("新增\n            ")])]),t._v(" "),r("el-button",{on:{click:t.editOrgSet}},[r("span",[t._v("修改\n            ")])]),t._v(" "),r("el-button",{on:{click:t.delOrg}},[r("span",[t._v("删除\n            ")])]),t._v(" "),r("el-button",{on:{click:t.delOrgs}},[r("span",[t._v("批量删除\n            ")])])],1),t._v(" "),r("el-main",{staticStyle:{margin:"0px",padding:"0px"}},[r("el-tree",{ref:"org",staticStyle:{"font-size":"16px","margin-top":"10px"},attrs:{"node-key":"id",props:{label:"title",disabled:!1,isLeaf:!0,children:"children"},"highlight-current":!0,"show-checkbox":!0,"check-strictly":!0,data:t.orgTtData},on:{"node-click":t.clickTreeItem,check:t.orgTreeCheck}})],1),t._v(" "),r("el-dialog",{attrs:{visible:t.showEditOrgSet,title:"部门编辑","append-to-body":!0,"destroy-on-close":!0},on:{"update:visible":function(e){t.showEditOrgSet=e}}},[r("orgedit",{attrs:{paramsObj:t.orgInstEdit},on:{submitOk:t.editOrgSetOK,submitClose:function(e){t.showEditOrgSet=!1}}})],1)],1)},[],!1,null,"ab5c0352",null);g.options.__file="index.vue";e.default=g.exports},"RU/L":function(t,e,r){r("Rqdy");var n=r("WEpk").Object;t.exports=function(t,e,r){return n.defineProperty(t,e,r)}},Rqdy:function(t,e,r){var n=r("Y7ZC");n(n.S+n.F*!r("jmDH"),"Object",{defineProperty:r("2faE").f})},SEkw:function(t,e,r){t.exports={default:r("RU/L"),__esModule:!0}},"U+t5":function(t,e,r){"use strict";r.r(e);var n=r("P2sY"),i=r.n(n),o=r("YEIV"),a=r.n(o),s={name:"orgedit",mixins:[r("y2a5").a],components:{},props:{paramsObj:{type:Object,default:function(){return{}}}},data:function(){var t;return t={newOrgForm:{id:0,title:"",type:"",parent_id:0,sort:0,data_scope:"",stop:"",memo:""},orgForm:{},orgData:[]},a()(t,"newOrgForm",{id:0,title:"",type:"部门",parent_id:0,sort:0,data_scope:"f",stop:"f",memo:""}),a()(t,"isInDialog",!1),a()(t,"pObj",{}),t},mounted:function(){console.log(" xxxxxx ------ "),this.pObj=i()({},this.paramsObj),this.gcomm.mapLength(this.pObj)>0?(this.isInDialog=!0,this.orgForm=i()({},this.newOrgForm,this.pObj)):this.orgForm=i()({},this.newOrgForm,this.$route.params)},methods:{pObjChanged:function(){this.gcomm.mapLength(this.pObj)>0&&(this.isInDialog=!0,this.orgForm=i()({},this.newOrgForm,this.pObj))},changedc6d8:function(t){for(var e=0;e<this.orgData.length;e++)this.orgData[e].id==this.orgForm.parent_id&&(this.orgForm.parent_title=this.orgData[e].title)},clickf5e8c:function(){this.submitOrgForm("orgForm")},handleClose:function(){this.isInDialog?this.$emit("submitClose"):this.$router.go(-1)},submitOrgFormImpl:function(t){var e=this,r=void 0,n=!0,o="";this[t].id>0?(r="/act",n=!1,o="deptup"):(r="/act",o="deptadd");var a=i()({},this[t]);a._hy=o,this.callSrvAct(r,a).then(function(t){console.log("res:",t,e.isInDialog),e.isInDialog?n?t.data&&t.data.inst?e.$emit("submitOk",t.data.inst):t.data&&e.$emit("submitOk",t.data||{}):e.$emit("submitOk",a):e.$router.go(-1)})},submitOrgForm:function(t){var e=this;this.$refs[t].validate(function(r){if(!r)return!1;e.submitOrgFormImpl(t)})}},watch:{paramsObj:function(t){this.pObj.id!=this.paramsObj.id&&(this.pObj=i()({},this.paramsObj),this.pObjChanged())}},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},l=(r("55c2"),r("KHd+")),c=Object(l.a)(s,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-container",{attrs:{direction:"vertical"}},[r("el-form",{ref:"orgForm",staticStyle:{padding:"10px"},attrs:{model:t.orgForm,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"部门名称",prop:"title",rules:{required:!0,message:"请输入正确的部门名称",min:1,max:200}}},[r("el-input",{model:{value:t.orgForm.title,callback:function(e){t.$set(t.orgForm,"title",e)},expression:"orgForm.title"}})],1),t._v(" "),t._e(),t._v(" "),t._e(),t._v(" "),t._e(),t._v(" "),t._e(),t._v(" "),t._e(),t._v(" "),t._e(),t._v(" "),r("el-row",{attrs:{type:"flex",justify:"center"}},[r("el-button",{on:{click:t.clickf5e8c}},[r("span",[t._v("确定\n                    ")])]),t._v(" "),r("el-button",{on:{click:t.handleClose}},[r("span",[t._v("取消\n                    ")])])],1)],1)],1)},[],!1,null,"84bc7020",null);c.options.__file="index.vue";e.default=c.exports},YEIV:function(t,e,r){"use strict";e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(r("SEkw"));e.default=function(t,e,r){return e in t?(0,n.default)(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},pp65:function(t,e,r){},y2a5:function(t,e,r){"use strict";var n=r("gDS+"),i=r.n(n),o=r("4d7F"),a=r.n(o);e.a={methods:{cb_null:function(t){return!1},cb_goBack:function(t){return this.$router.go(-1),!0},cb_success:function(t){return!(!t.status||"SUCCESS"!=t.status)||(this.$message.error(t.msg),!1)},cb_showMess:function(t){return this.$message.success(t.msg),!0},gen_sameValue:function(t,e){return function(r,n,i){n!=t?i(new Error(e)):i()}},refreshCaptcha:function(t){t.preventDefault(),t.target.src=this.hysrvport+"/captcha?"+Math.random()},add_authToken:function(t){return t.length<1?"":t=t.indexOf("?")>-1?t+"&Authorization="+this.apiSrv.token:t+"?Authorization="+this.apiSrv.token},callServer:function(t,e,r){var n=this;this.apiSrv.callServer(t,e).then(function(t){if(console.log("res ------",t),r)for(var e=0;e<r.length;e++){if(r[e])if(!r[e](t))break}}).catch(function(t){console.log("err:",t),n.$message.error(t)})},callSrvAct:function(t,e){var r=this;return new a.a(function(n,i){r.apiSrv.callServer(t,e).then(function(t){t.status&&"SUCCESS"==t.status?n(t):(console.log("res:",t),r.$message.error(t.msg))}).catch(function(t){console.log("err:",t),r.$message.error(t)})})},gen_list_cb:function(t,e){var r=this;if(!t||t.length<1)return this.cb_null;var n=t+"Data",i=t+"TotalRec",o=t+"TotalPage",a=t+"RecOfPage",s=t+"CurPage";return function(t){return e&&1==e&&t.data.cp>1?r[n]=r[n].concat(t.data.pageData||[]):r[n]=t.data.pageData||[],r[i]=t.data.totalRec,r[a]=t.data.rop,r[s]=t.data.cp,r[o]=t.data.rop>0?Math.ceil(t.data.totalRec/t.data.rop):0,t.data.detailData&&(r[n+"dData"]=t.data.detailData||[]),!0}},gen_selmulti_change:function(t){var e=this;if(!t||t.length<1)return this.cb_null;var r=t+"MultiSel";return function(t){if(e[r]){for(var n=[],i=0;i<t.length;i++)n.push(t[i].id);e[r]=n}}},refreshPage2:function(t,e,r,n,o,a){var s=t+"QueryArr",l=t+"CbPage",c=JSON.parse(i()(this[s]));if(c&&c.length>0)for(var h=c.length-1;h>-1;h--)console.log("qpsArr[i].val",c[h].val,0==c[h].val,""!=c[h].val),0==c[h].val&&(console.log("i:",h),c.splice(h,1));console.log("qpsArr:",c,this[s]);var g={qps:c||"",rop:r,cp:n};return this[t+"SortParas"]&&(g.sps=this[t+"SortParas"]),g._hy=o,this.callServer(e,g,[this.cb_success,this[l],a])},refreshPage:function(t,e,r,n){var i=t+"RecOfPage",o=t+"CurPage";this[o]<1&&(this[o]=1),this.refreshPage2(t,e,this[i],this[o],r,n)},queryPageData:function(t,e,r,n,o,a){if(!t||t.length<1)return this.cb_null;var s=t+"QueryArr",l=JSON.parse(i()(this[s]));if(l&&l.length>0)for(var c=l.length-1;c>-1;c--)0==l[c].val&&l.splice(c,1);console.log("qpsArr:",l);var h={qps:l||[],rop:r,cp:n};return this[t+"SortParas"]&&(h.sps=this[t+"SortParas"]),h._hy=o,this.callServer(e,h,a)}}}}}]);