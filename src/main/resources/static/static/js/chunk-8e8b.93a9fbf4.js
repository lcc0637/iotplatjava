(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-8e8b","chunk-a410"],{"2uve":function(e,t,a){},Ax9J:function(e,t,a){"use strict";a.r(t);var i=a("uiSD"),l={name:"seleype",mixins:[a("y2a5").a],components:{Pushpeople:i.default},props:{},data:function(){return{algorithmaccData:[],algorithmaccTotalRec:0,algorithmaccTotalPage:0,algorithmaccRecOfPage:10,algorithmaccCurPage:1,algorithmaccCbPage:this.gen_list_cb("algorithmacc"),algorithmaccQueryArr:[],algorithmaccQueryInit:[],algorithmaccMultiSel:[],cameraData:[],cameraTotalRec:0,cameraTotalPage:0,cameraRecOfPage:10,cameraCurPage:1,cameraCbPage:this.gen_list_cb("camera"),cameraQueryArr:[],cameraQueryInit:[],cameraMultiSel:[],peopleData:[],peopleTotalRec:0,peopleTotalPage:0,peopleRecOfPage:10,peopleCurPage:1,peopleCbPage:this.gen_list_cb("people"),peopleQueryArr:[],peopleQueryInit:[],peopleMultiSel:[],show:!1,pushpeopleEdit:null,active:1,crossborderdirection:[{value:"外部",label:"外部"},{value:"内部",label:"内部"}],crossborderdirectionvalue:"",x:0,y:0,warningtime:0,whole:0,choice:1,timeslot:[]}},mounted:function(){this.refreshPage("algorithmacc","/actq","algorithmacclist"),this.refreshPage("camera","/actq","cameralist")},methods:{algorithmaccMultiSelChange:function(e){this.algorithmaccMultiSel=e},cameraMultiSelChange:function(e){this.cameraMultiSel=e},peopleMultiSelChange:function(e){this.peopleMultiSel=e},algorithmaccSizeChange:function(e){this.refreshPage2("algorithmacc","/actq",e,this.algorithmaccCurPage,"algorithmacclist")},algorithmaccCurChange:function(e){this.refreshPage2("algorithmacc","/actq",this.algorithmaccRecOfPage,e,"algorithmacclist")},cameraSizeChange:function(e){this.refreshPage2("camera","/actq",e,this.cameraCurPage,"cameralist")},cameraCurChange:function(e){this.refreshPage2("camera","/actq",this.cameraRecOfPage,e,"cameralist")},handleClick:function(){this.active=this.active+1,this.active>4&&(this.active=4),console.log(this.cameraMultiSel),0==this.cameraMultiSel.length&&(this.cameraMultiSel=[{id:0,title:"",region_id:0,region_title:"",pos:"",resolution:"",url:"",codec:"",scene:"",framerate:"",corp:"",videoa:"",state:"",algorithms:""}])},goBack:function(){this.active=this.active-1,this.active<1&&(this.active=1)},complete:function(){var e=this;this.active=4,console.log("所有选择数据",this.algorithmaccMultiSel,this.cameraMultiSel,this.peopleMultiSel,this.crossborderdirectionvalue);var t={id:0,algorithm_id:this.algorithmaccMultiSel[0].id,title:this.algorithmaccMultiSel[0].title,status:"运行中",camera_id:this.cameraMultiSel[0].id,cameratitle:this.cameraMultiSel[0].title,opentime:(new Date).getTime(),user_id:this.peopleMultiSel[0].id,user_title:this.peopleMultiSel[0].title,para:this.crossborderdirectionvalue};0==this.warningtime?(t.pushtime_start=0,t.pushtime_end=0):(t.pushtime_start=this.timeslot[0],t.pushtime_end=this.timeslot[1]),t._hy="algorithmadd",this.callSrvAct("/act",t).then(function(t){console.log(t),"SUCCESS"==t.status&&e.$router.push({name:"algorithmm"})})},handlealgorithmChange:function(e){console.log(e),this.algorithmaccMultiSel=e},handleChange:function(e){this.cameraMultiSel=e},paint:function(e){var t=this.$refs.cvs.getContext("2d");0==this.x&&0==this.y&&(this.x=e.layerX,this.y=e.layery),t.moveTo(this.x,this.y),t.lineTo(e.layerX,e.layerY),t.stroke(),this.x=e.layerX,this.y=e.layerY},handlePeople:function(){this.pushpeopleEdit={},this.show=!0},peopleChange:function(e){console.log(e),this.peopleMultiSel=e},peopledel:function(e,t){var a=this;this.$confirm("此操作将删除该项数, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.peopleData.splice(e,1)}).catch(function(e){a.$message.error(e)})},peopledels:function(){var e=this;this.$confirm("此操作将删除该项数, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){}).catch(function(t){e.$message.error(t)})},pushpeopleOK:function(e){console.log("传回来的",e);for(var t=0;t<e.length;t++)this.peopleData.push(e[t]);this.show=!1},pushpeopleSet:function(){},SizeChange:function(){},CurChange:function(){},enen:function(e){console.log("选中的值",this.timeslot)}},watch:{},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},r=(a("u9mS"),a("KHd+")),n=Object(r.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{direction:"vertical"}},[a("div",{staticStyle:{"text-align":"center"}},[a("span",[e._v("请依次进行任务配置\n        ")])]),e._v(" "),a("el-steps",{attrs:{active:e.active}},[a("el-step",{attrs:{description:"算法"}}),e._v(" "),a("el-step",{attrs:{description:"摄像机"}}),e._v(" "),a("el-step",{attrs:{description:"任务参数"}}),e._v(" "),a("el-step",{attrs:{description:"选择推送人员"}})],1),e._v(" "),1==e.active?a("div",[a("el-table",{ref:"algorithmacc",attrs:{"header-cell-style":{background:"rgba(241,246,254,1)",fontWeight:"500",color:"#333333",fontSize:"16px"},id:"algorithmacc",data:e.algorithmaccData},on:{"selection-change":e.handlealgorithmChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:"算法名称",prop:"title"}}),e._v(" "),a("el-table-column",{attrs:{label:"描述",prop:"describion"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-pagination",{attrs:{total:e.algorithmaccTotalRec,"page-count":e.algorithmaccTotalPage,layout:"total, sizes, prev, pager, next"},on:{"size-change":e.algorithmaccSizeChange,"current-change":e.algorithmaccCurChange}})],1)],1):e._e(),e._v(" "),2==e.active?a("div",[a("el-table",{ref:"camera",attrs:{"header-cell-style":{background:"rgba(241,246,254,1)",fontWeight:"500",color:"#333333",fontSize:"16px"},id:"camera",data:e.cameraData},on:{"selection-change":e.handleChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:"摄像机名称",prop:"title"}}),e._v(" "),a("el-table-column",{attrs:{label:"位置",prop:"region_title"}}),e._v(" "),a("el-table-column",{attrs:{label:"视频地址",prop:"videoa"}}),e._v(" "),a("el-table-column",{attrs:{label:"分辨率",prop:"resolution"}}),e._v(" "),a("el-table-column",{attrs:{label:"帧率",prop:"framerate"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-pagination",{attrs:{total:e.cameraTotalRec,"page-count":e.cameraTotalPage,layout:"total, sizes, prev, pager, next"},on:{"size-change":e.cameraSizeChange,"current-change":e.cameraCurChange}})],1)],1):e._e(),e._v(" "),3==e.active?a("div",{staticStyle:{border:"1px solid #000"}},[a("div",{staticStyle:{display:"flex","justify-content":"space-around","border-bottom":"1px solid #000"}},[a("div",[a("span",{staticStyle:{display:"block",width:"100%",height:"100%"}},[a("canvas",{ref:"cvs",staticStyle:{width:"100%",height:"100%",border:"1px solid blue"},attrs:{id:"cvs"},on:{click:e.paint}},[e._v("不支持canvas")])])]),e._v(" "),a("div",[a("el-row",{staticStyle:{"margin-top":"10px"},attrs:{autogenchild:!1,childcol:24}},[a("span",{staticStyle:{"font-size":"18px","font-weight":"500"}},[e._v(e._s(e.cameraMultiSel[0].title)+"\n                    ")])]),e._v(" "),a("el-row",{staticStyle:{"margin-top":"10px"},attrs:{autogenchild:!1,childcol:24}},[a("span",[e._v("摄像机位置：\n                    ")]),e._v(" "),a("span",[e._v(e._s(e.cameraMultiSel[0].region_title)+"\n                    ")])]),e._v(" "),a("el-row",{staticStyle:{"margin-top":"10px"},attrs:{autogenchild:!1,childcol:24}},[a("span",[e._v("视频流地址：\n                    ")]),e._v(" "),a("span",[e._v(e._s(e.cameraMultiSel[0].videoa)+"\n                    ")])]),e._v(" "),a("el-row",{staticStyle:{"margin-top":"10px"},attrs:{autogenchild:!1,childcol:24}},[a("span",[e._v("分辨率：\n                    ")]),e._v(" "),a("span",[e._v(e._s(e.cameraMultiSel[0].resolution)+"\n                    ")])]),e._v(" "),a("el-row",{staticStyle:{margin:"10px 0px"},attrs:{autogenchild:!1,childcol:24}},[a("span",[e._v("帧率：\n                    ")]),e._v(" "),a("span",[e._v(e._s(e.cameraMultiSel[0].framerate)+"\n                    ")])])],1)]),e._v(" "),a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",[a("el-row",{staticStyle:{"margin-top":"10px"},attrs:{autogenchild:!1,childcol:24}},[a("span",{staticStyle:{"font-size":"18px","font-weight":"500","margin-left":"10px"}},[e._v("参数配置\n                    ")])]),e._v(" "),a("el-row",{staticStyle:{"margin-top":"10px"},attrs:{autogenchild:!1,childcol:24}},[a("span",{staticStyle:{"margin-left":"40px"}},[e._v("越界边界：\n                    ")]),e._v(" "),a("span",{staticStyle:{color:"#aaaaaa"}},[e._v("越界检测划定的多边形界限\n                    ")])]),e._v(" "),a("el-row",{staticStyle:{margin:"10px 0px"},attrs:{autogenchild:!1,childcol:24}},[a("span",{staticStyle:{"margin-left":"40px"}},[e._v("越界方向\n                    ")]),e._v(" "),a("el-select",{model:{value:e.crossborderdirectionvalue,callback:function(t){e.crossborderdirectionvalue=t},expression:"crossborderdirectionvalue"}},e._l(e.crossborderdirection,function(e,t){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("div",[a("el-row",{staticStyle:{"margin-top":"10px"},attrs:{autogenchild:!1,childcol:24}},[a("span",{staticStyle:{"font-size":"18px","font-weight":"500","margin-left":"10px"}},[e._v("预警时间段\n                    ")])]),e._v(" "),a("div",{staticStyle:{display:"flex","margin-top":"16px"}},[a("div",[a("el-radio-group",{on:{change:e.enen},model:{value:e.warningtime,callback:function(t){e.warningtime=t},expression:"warningtime"}},[a("el-radio",{attrs:{label:e.whole}},[a("span",[e._v("全部\n                                ")])]),e._v(" "),a("el-radio",{staticStyle:{display:"block","margin-top":"23px"},attrs:{label:e.choice}},[a("span",[e._v("选择\n                                ")])])],1)],1),e._v(" "),a("div",{staticStyle:{"margin-top":"25px"}},[a("el-date-picker",{attrs:{"value-format":"timestamp","start-placeholder":"请选择开始时间","end-placeholder":"请选择结束时间",type:"datetimerange"},model:{value:e.timeslot,callback:function(t){e.timeslot=t},expression:"timeslot"}})],1)])],1)])]):e._e(),e._v(" "),4==e.active?a("div",[a("div",{staticStyle:{margin:"10px 0px"}},[a("el-button",{on:{click:e.handlePeople}},[a("span",[a("i",{staticClass:"el-icon-plus"}),e._v(" 选择推送人员\n                ")])]),e._v(" "),a("el-button",{on:{click:e.peopledels}},[a("span",[e._v("批量删除\n                ")])])],1),e._v(" "),a("el-table",{ref:"people",staticStyle:{"margin-bottom":"10px"},attrs:{"header-cell-style":{background:"rgba(241,246,254,1)",fontWeight:"500",color:"#333333",fontSize:"16px"},data:e.peopleData},on:{"selection-change":e.peopleChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:"部门",prop:"parent_title"}}),e._v(" "),a("el-table-column",{attrs:{label:"姓名",prop:"title"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){e.peopledel(t.$index,t.row)}}},[a("span",[e._v("删除\n                        ")])])]}}])})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next"},on:{"size-change":e.SizeChange,"current-change":e.CurChange}})],1)],1):e._e(),e._v(" "),a("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[2==e.active||3==e.active||4==e.active?a("el-button",{on:{click:e.goBack}},[a("span",[e._v("上一步\n            ")])]):e._e(),e._v(" "),1==e.active||2==e.active||3==e.active?a("el-button",{on:{click:e.handleClick}},[a("span",[e._v("下一步\n            ")])]):e._e(),e._v(" "),4==e.active?a("el-button",{on:{click:e.complete}},[a("span",[e._v("完成\n            ")])]):e._e()],1),e._v(" "),a("el-dialog",{attrs:{visible:e.show,title:"选择推送人员","destroy-on-close":!0},on:{"update:visible":function(t){e.show=t}}},[a("pushpeople",{attrs:{paramsObj:e.pushpeopleEdit},on:{submitOk:e.pushpeopleOK,submitClose:e.pushpeopleSet}})],1)],1)},[],!1,null,"7d2b3cfe",null);n.options.__file="index.vue";t.default=n.exports},lw5U:function(e,t,a){},u9mS:function(e,t,a){"use strict";var i=a("lw5U");a.n(i).a},uZ1Q:function(e,t,a){"use strict";var i=a("2uve");a.n(i).a},uiSD:function(e,t,a){"use strict";a.r(t);var i=a("gDS+"),l=a.n(i),r={name:"pushpeople",mixins:[a("y2a5").a],components:{},props:{paramsObj:{type:Object,default:function(){return{}}}},data:function(){return{pushuserData:[],pushuserTotalRec:0,pushuserTotalPage:0,pushuserRecOfPage:10,pushuserCurPage:1,pushuserCbPage:this.gen_list_cb("pushuser"),pushuserQueryArr:[{name:"parent_id",val:0,tb:"user"},{name:"title",val:"",op:"like",tb:"user"}],pushuserQueryInit:[{name:"parent_id",val:0,tb:"user"},{name:"title",val:"",op:"like",tb:"user"}],pushuserMultiSel:[],pushuserSortParas:[{name:"title",tb:"user",orderV:"asc"}],departmentArr:[],pobj:{}}},mounted:function(){var e=this;this.refreshPage("pushuser","/actq","pushuserlist");var t=this;this.callSrvAct("/actq",{_hy:"orgtt",qps:[{name:"title",val:"",op:"like"}],sps:[{name:"title",orderV:"asc"}]}).then(function(a){var i=a.data||[];console.log("部门数据",i),t.departmentArr=i,e.departmentArr.splice(0,0,{id:0,title:"全部"})}),this.pobj=this.paramsObj},methods:{pushuserMultiSelChange:function(e){this.pushuserMultiSel=e},pushuserQuery:function(){this.refreshPage2("pushuser","/actq",this.remoteRecOfPage,1,"pushuserlist")},pushuserResetQuery:function(){this.pushuserQueryArr=JSON.parse(l()(this.pushuserQueryInit))},pushuserSizeChange:function(e){this.refreshPage2("pushuser","/actq",e,this.pushuserCurPage,"pushuserlist")},pushuserCurChange:function(e){this.refreshPage2("pushuser","/actq",this.pushuserRecOfPage,e,"pushuserlist")},handleChange:function(e){this.pushuserMultiSel=e,console.log(this.pushuserMultiSel)},determine:function(){if(console.log("父组件传的",this.pobj),"id"in this.pobj){var e=this.pobj;e.user_id=this.pushuserMultiSel[0].id,e.user_title=this.pushuserMultiSel[0].title,this.$emit("submitOk",e)}else this.$emit("submitOk",this.pushuserMultiSel)},search:function(){this.refreshPage("pushuser","/actq","pushuserlist")}},watch:{},computed:{},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}},n=(a("uZ1Q"),a("KHd+")),s=Object(n.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{attrs:{direction:"vertical"}},[a("div",[a("el-select",{attrs:{placeholder:"请选择部门"},model:{value:e.pushuserQueryArr[0].val,callback:function(t){e.$set(e.pushuserQueryArr[0],"val",t)},expression:"pushuserQueryArr[0].val"}},e._l(e.departmentArr,function(e,t){return a("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})})),e._v(" "),a("el-input",{staticStyle:{width:"220px",margin:"0px 10px"},attrs:{placeholder:"请输入姓名"},model:{value:e.pushuserQueryArr[1].val,callback:function(t){e.$set(e.pushuserQueryArr[1],"val",t)},expression:"pushuserQueryArr[1].val"}}),e._v(" "),a("el-button",{on:{click:e.search}},[a("span",[e._v("搜索\n            ")])])],1),e._v(" "),a("el-table",{ref:"pushuser",staticStyle:{margin:"10px 0px"},attrs:{"header-cell-style":{background:"rgba(241,246,254,1)",fontWeight:"500",color:"#333333",fontSize:"16px"},data:e.pushuserData},on:{"selection-change":e.handleChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:"姓名",prop:"title"}}),e._v(" "),a("el-table-column",{attrs:{label:"岗位",prop:"job_title"}}),e._v(" "),a("el-table-column",{attrs:{label:"手机号",prop:"mobile"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-pagination",{attrs:{total:e.pushuserTotalRec,"page-count":e.pushuserTotalPage,layout:"total, sizes, prev, pager, next"},on:{"size-change":e.pushuserSizeChange,"current-change":e.pushuserCurChange}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",[a("span",[e._v("取消\n            ")])]),e._v(" "),a("el-button",{on:{click:e.determine}},[a("span",[e._v("确定\n            ")])])],1)],1)},[],!1,null,"45ff25ac",null);s.options.__file="index.vue";t.default=s.exports},y2a5:function(e,t,a){"use strict";var i=a("gDS+"),l=a.n(i),r=a("4d7F"),n=a.n(r);t.a={methods:{cb_null:function(e){return!1},cb_goBack:function(e){return this.$router.go(-1),!0},cb_success:function(e){return!(!e.status||"SUCCESS"!=e.status)||(this.$message.error(e.msg),!1)},cb_showMess:function(e){return this.$message.success(e.msg),!0},gen_sameValue:function(e,t){return function(a,i,l){i!=e?l(new Error(t)):l()}},refreshCaptcha:function(e){e.preventDefault(),e.target.src=this.hysrvport+"/captcha?"+Math.random()},add_authToken:function(e){return e.length<1?"":e=e.indexOf("?")>-1?e+"&Authorization="+this.apiSrv.token:e+"?Authorization="+this.apiSrv.token},callServer:function(e,t,a){var i=this;this.apiSrv.callServer(e,t).then(function(e){if(console.log("res ------",e),a)for(var t=0;t<a.length;t++){if(!a[t](e))break}}).catch(function(e){console.log("err:",e),i.$message.error(e)})},callSrvAct:function(e,t){var a=this;return new n.a(function(i,l){a.apiSrv.callServer(e,t).then(function(e){e.status&&"SUCCESS"==e.status?i(e):(console.log("res:",e),a.$message.error(e.msg))}).catch(function(e){console.log("err:",e),a.$message.error(e)})})},gen_list_cb:function(e,t){var a=this;if(!e||e.length<1)return this.cb_null;var i=e+"Data",l=e+"TotalRec",r=e+"TotalPage",n=e+"RecOfPage",s=e+"CurPage";return function(e){return t&&1==t&&e.data.cp>1?a[i]=a[i].concat(e.data.pageData||[]):a[i]=e.data.pageData||[],a[l]=e.data.totalRec,a[n]=e.data.rop,a[s]=e.data.cp,a[r]=e.data.rop>0?Math.ceil(e.data.totalRec/e.data.rop):0,e.data.detailData&&(a[i+"dData"]=e.data.detailData||[]),!0}},gen_selmulti_change:function(e){var t=this;if(!e||e.length<1)return this.cb_null;var a=e+"MultiSel";return function(e){if(t[a]){for(var i=[],l=0;l<e.length;l++)i.push(e[l].id);t[a]=i}}},refreshPage2:function(e,t,a,i,r){var n=e+"QueryArr",s=e+"CbPage",o=JSON.parse(l()(this[n]));if(o&&o.length>0)for(var c=o.length-1;c>-1;c--)console.log("qpsArr[i].val",o[c].val,0==o[c].val,""!=o[c].val),0==o[c].val&&(console.log("i:",c),o.splice(c,1));console.log("qpsArr:",o,this[n]);var u={qps:o||"",rop:a,cp:i};return this[e+"SortParas"]&&(u.sps=this[e+"SortParas"]),u._hy=r,this.callServer(t,u,[this.cb_success,this[s]])},refreshPage:function(e,t,a){var i=e+"RecOfPage",l=e+"CurPage";this[l]<1&&(this[l]=1),this.refreshPage2(e,t,this[i],this[l],a)},queryPageData:function(e,t,a,i,r){if(!e||e.length<1)return this.cb_null;var n=e+"QueryArr",s=JSON.parse(l()(this[n]));if(s&&s.length>0)for(var o=s.length-1;o>-1;o--)0==s[o].val&&s.splice(o,1);console.log("qpsArr:",s);var c={qps:s||[],rop:a,cp:i};return this[e+"SortParas"]&&(c.sps=this[e+"SortParas"]),this.callServer(t,c,r)}}}}}]);